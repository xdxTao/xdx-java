import{_ as r}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as o,a as c,w as i,b as n,r as p,o as d,f as t,e}from"./app-Q2dkLXYo.js";const h="/assets/0601_29-1womA0ds.png",b="/assets/0601_31-D_CA-sUp.png",u="/assets/0601_30-Dy0OM9YQ.png",g="/assets/0601_32-Cjg8wsW6.png",k="/assets/0601_33-WxJo4Q7K.png",m={},E=n(`<p><a href="https://www.bilibili.com/video/BV1UQ26YpESe" target="_blank" rel="noopener noreferrer">B站学习视频</a></p><br><p>代码演示环境</p><ul><li>Dubbo 3.2.9</li><li>Nacos 2.3.0</li></ul><br><h2 id="一、什么是接口级和应用级" tabindex="-1"><a class="header-anchor" href="#一、什么是接口级和应用级"><span>一、什么是接口级和应用级</span></a></h2><br><p>假设有一个服务A，里面提供了2个Dubbo接口XdxOneService、XdxTwoService，Dubbo生产者把服务注册到Nacos（或其它的注册中心）</p><p>以应用级别注册，在Nacos上就只看到一个服务名称A（取自 dubbo.application.name） <br> 以接口级别注册，就会看到两个服务</p><ul><li>providers:com.xdx97.dubbo3.api.XdxOneService:1.0.0:</li><li>providers:com.xdx97.dubbo3.api.XdxTwoService:1.0.0:</li></ul><br><div class="hint-container note"><p class="hint-container-title">可以同时注册应用级和接口级</p></div><br><h3 id="_1、为什么要有这两种不同的级别-适用场景是什么" tabindex="-1"><a class="header-anchor" href="#_1、为什么要有这两种不同的级别-适用场景是什么"><span>1、为什么要有这两种不同的级别，适用场景是什么</span></a></h3><br><div class="hint-container important"><p class="hint-container-title">Dubbo 最开始只有接口级，应用级出现是为了提升性能</p></div><p>Dubbo生产者把所有的服务信息以接口级别注册到Nacos，假设A服务有100个接口，A服务部署了10份，Nacos就有 100*10 条注册信息</p><p>信息变动需要推送给消费者，那么大量的信息，可想而知，对Nacos、消费者都是个负担，会影响系统的运行</p><p>还是上面的条件，如果改为应用级就只需要注册 10 条信息，而且每条信息量还要更少（接口级的信息量更全）</p><p><strong>应用级情况下，消费者拿到生产者的信息，再通过RPC去请求生产者拿到类似接口级别的信息数据，从功能上是一样的，但解决了Nacos大量数据推送问题</strong></p><br><h3 id="_2、默认" tabindex="-1"><a class="header-anchor" href="#_2、默认"><span>2、默认</span></a></h3><br><ol><li>默认情况下，Dubbo3的生产者是同时注册两种级别，消费者也同时支持这两种消费</li><li>应用级别出现的目的是为了解决大数量导致的问题，如果规模不大，也可以不用这种方式</li><li>建议新创建的服务 生产者用 应用级，消费者 指定消费 应用级 （下面讲怎么设置）</li></ol><br><h2 id="二、生产者、消费者-配置应用级和接口级" tabindex="-1"><a class="header-anchor" href="#二、生产者、消费者-配置应用级和接口级"><span>二、生产者、消费者 配置应用级和接口级</span></a></h2><br><h3 id="_1、生产者配置" tabindex="-1"><a class="header-anchor" href="#_1、生产者配置"><span>1、生产者配置</span></a></h3><br><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">dubbo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  registry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    registerMode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">interface</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>registerMode 的选择 <code>interface</code>、 <code>instance</code>、<code>all</code></p><br>`,32),v=e("figure",null,[e("img",{src:h,alt:"",tabindex:"0",loading:"lazy"}),e("figcaption")],-1),A=e("figure",null,[e("img",{src:b,alt:"",tabindex:"0",loading:"lazy"}),e("figcaption")],-1),_=e("figure",null,[e("img",{src:u,alt:"",tabindex:"0",loading:"lazy"}),e("figcaption")],-1),y=n(`<br><h3 id="_2、消费者配置" tabindex="-1"><a class="header-anchor" href="#_2、消费者配置"><span>2、消费者配置</span></a></h3><br><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">dubbo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  application</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    service-discovery</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      migration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">FORCE_APPLICATION</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>migration 的选择 <code>FORCE_APPLICATION</code>、<code>FORCE_INTERFACE</code>、 <code>APPLICATION_FIRST</code></p><ol><li>APPLICATION_FIRST 优先应用级，如果没有应用级就会处理 接口级</li><li>当设置 强制应用或接口级的时候，如果生产者没有对应的级别就会报错</li></ol><br><h2 id="三、其它" tabindex="-1"><a class="header-anchor" href="#三、其它"><span>三、其它</span></a></h2><br><h3 id="_1、消费者也注册到nacos" tabindex="-1"><a class="header-anchor" href="#_1、消费者也注册到nacos"><span>1、消费者也注册到Nacos</span></a></h3><br><p>有时候我们需要把消费者也注册到Nacos上去，做如下配置</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">dubbo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  registry</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    parameters.register-consumer-url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="`+g+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><br><p>如果设置强制消费应用级（FORCE_APPLICATION），消费者就注册不到Nacos了，不影响服务调用，只是在Nacos看不到</p><p>如果没有特别场景要看某个消费者，这也不影响，我们可以通过生产者查看消费者</p><figure><img src="'+k+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><br><p>应用名 为unknown 参看 <a href="https://nacos.io/en/blog/faq/nacos-user-question-history14773/?source=wuyi#%E5%8E%9F%E5%9B%A0%E5%88%86%E6%9E%90" target="_blank" rel="noopener noreferrer">INF0 receive config info: unknown#racos2-0.nacos2-hea</a></p><br><p>参考文档</p><ol><li><a href="https://cn.dubbo.apache.org/zh-cn/overview/mannual/java-sdk/reference-manual/registry/service-discovery-application-vs-interface/" target="_blank" rel="noopener noreferrer">应用级服务发现 vs 接口级服务发现</a></li><li><a href="https://cn.dubbo.apache.org/zh-cn/blog/2024/05/13/%E5%A6%82%E6%9E%9C%E4%BB%8E%E6%8E%A5%E5%8F%A3%E7%BA%A7%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E5%B9%B3%E6%BB%91%E8%BF%81%E7%A7%BB%E5%88%B0%E5%BA%94%E7%94%A8%E7%BA%A7%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0/" target="_blank" rel="noopener noreferrer">如果从接口级服务发现平滑迁移到应用级服务发现</a></li><li><a href="https://cn.dubbo.apache.org/zh-cn/overview/mannual/java-sdk/reference-manual/registry/nacos/" target="_blank" rel="noopener noreferrer">使用 Nacos 作为注册中心实现自动服务发现</a></li></ol>',23);function f(B,D){const l=p("Tabs");return d(),o("div",null,[E,c(l,{id:"100",data:[{id:"all"},{id:"instance"},{id:"interface"}]},{title0:i(({value:a,isActive:s})=>[t("all")]),title1:i(({value:a,isActive:s})=>[t("instance")]),title2:i(({value:a,isActive:s})=>[t("interface")]),tab0:i(({value:a,isActive:s})=>[v]),tab1:i(({value:a,isActive:s})=>[A]),tab2:i(({value:a,isActive:s})=>[_]),_:1}),y])}const N=r(m,[["render",f],["__file","7、Dubbo接口级和应用级注册.html.vue"]]),F=JSON.parse('{"path":"/06%E5%BE%AE%E6%9C%8D%E5%8A%A1/01Dubbo/7%E3%80%81Dubbo%E6%8E%A5%E5%8F%A3%E7%BA%A7%E5%92%8C%E5%BA%94%E7%94%A8%E7%BA%A7%E6%B3%A8%E5%86%8C.html","title":"【中】Dubbo接口级和应用级注册，Dubbo消费者注册到Nacos","lang":"zh-CN","frontmatter":{"title":"【中】Dubbo接口级和应用级注册，Dubbo消费者注册到Nacos","shortTitle":"【中】Dubbo接口级和应用级注册","date":"2024-10-13T14:50:01.000Z","category":["中级","视频讲解"],"tag":["Dubbo","Dubbo3"],"order":7,"description":"B站学习视频 代码演示环境 Dubbo 3.2.9 Nacos 2.3.0 一、什么是接口级和应用级 假设有一个服务A，里面提供了2个Dubbo接口XdxOneService、XdxTwoService，Dubbo生产者把服务注册到Nacos（或其它的注册中心） 以应用级别注册，在Nacos上就只看到一个服务名称A（取自 dubbo.applicati...","head":[["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/06%E5%BE%AE%E6%9C%8D%E5%8A%A1/01Dubbo/7%E3%80%81Dubbo%E6%8E%A5%E5%8F%A3%E7%BA%A7%E5%92%8C%E5%BA%94%E7%94%A8%E7%BA%A7%E6%B3%A8%E5%86%8C.html"}],["meta",{"property":"og:site_name","content":"小道仙Java笔记"}],["meta",{"property":"og:title","content":"【中】Dubbo接口级和应用级注册，Dubbo消费者注册到Nacos"}],["meta",{"property":"og:description","content":"B站学习视频 代码演示环境 Dubbo 3.2.9 Nacos 2.3.0 一、什么是接口级和应用级 假设有一个服务A，里面提供了2个Dubbo接口XdxOneService、XdxTwoService，Dubbo生产者把服务注册到Nacos（或其它的注册中心） 以应用级别注册，在Nacos上就只看到一个服务名称A（取自 dubbo.applicati..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-13T14:10:29.000Z"}],["meta",{"property":"article:author","content":"小道仙97"}],["meta",{"property":"article:tag","content":"Dubbo"}],["meta",{"property":"article:tag","content":"Dubbo3"}],["meta",{"property":"article:published_time","content":"2024-10-13T14:50:01.000Z"}],["meta",{"property":"article:modified_time","content":"2024-10-13T14:10:29.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"【中】Dubbo接口级和应用级注册，Dubbo消费者注册到Nacos\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-10-13T14:50:01.000Z\\",\\"dateModified\\":\\"2024-10-13T14:10:29.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"小道仙97\\",\\"url\\":\\"https://java.xdx97.com\\"}]}"]]},"headers":[{"level":2,"title":"一、什么是接口级和应用级","slug":"一、什么是接口级和应用级","link":"#一、什么是接口级和应用级","children":[{"level":3,"title":"1、为什么要有这两种不同的级别，适用场景是什么","slug":"_1、为什么要有这两种不同的级别-适用场景是什么","link":"#_1、为什么要有这两种不同的级别-适用场景是什么","children":[]},{"level":3,"title":"2、默认","slug":"_2、默认","link":"#_2、默认","children":[]}]},{"level":2,"title":"二、生产者、消费者 配置应用级和接口级","slug":"二、生产者、消费者-配置应用级和接口级","link":"#二、生产者、消费者-配置应用级和接口级","children":[{"level":3,"title":"1、生产者配置","slug":"_1、生产者配置","link":"#_1、生产者配置","children":[]},{"level":3,"title":"2、消费者配置","slug":"_2、消费者配置","link":"#_2、消费者配置","children":[]}]},{"level":2,"title":"三、其它","slug":"三、其它","link":"#三、其它","children":[{"level":3,"title":"1、消费者也注册到Nacos","slug":"_1、消费者也注册到nacos","link":"#_1、消费者也注册到nacos","children":[]}]}],"git":{"createdTime":1728828629000,"updatedTime":1728828629000,"contributors":[{"name":"ziyangtao","email":"ziyangtao@distinctclinic.com","commits":1}]},"readingTime":{"minutes":3.2,"words":961},"filePathRelative":"06微服务/01Dubbo/7、Dubbo接口级和应用级注册.md","localizedDate":"2024年10月13日","excerpt":"<p><a href=\\"https://www.bilibili.com/video/BV1UQ26YpESe\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">B站学习视频</a></p>\\n<br>\\n<p>代码演示环境</p>\\n<ul>\\n<li>Dubbo 3.2.9</li>\\n<li>Nacos 2.3.0</li>\\n</ul>\\n<br>\\n<h2>一、什么是接口级和应用级</h2>\\n<br>\\n<p>假设有一个服务A，里面提供了2个Dubbo接口XdxOneService、XdxTwoService，Dubbo生产者把服务注册到Nacos（或其它的注册中心）</p>","autoDesc":true}');export{N as comp,F as data};
