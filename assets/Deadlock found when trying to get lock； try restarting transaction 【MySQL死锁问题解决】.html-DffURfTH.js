import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,o as a,d as h}from"./app-CPTE7G04.js";const n="/assets/0301_24-CU-kn8_p.png",k={},l=h(`<br><p>视频地址： <a href="https://www.bilibili.com/video/bv1zY411N7tB" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/video/bv1zY411N7tB</a></p><p><br><br></p><blockquote><p>最近在调试接口的时候遇到了MySQL死锁问题，我自己测试的时候一切都好好的，但在并发下，就死锁了 <br> 其实死锁问题，并没有一个类似“万金油”的解决办法，解铃还需系铃人，能做的只有写这个代码的人自己去解决 <br> 第一次出现死锁，想必你也会和我一样整个人都是懵的，不知道如何下手，等你看过下面的文章明白了死锁，就不会害怕了</p></blockquote><p><strong>死锁异常</strong></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">2022-06-15</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 16:05:22.216</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ERROR</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 38907</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [  </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">XNIO-1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> task-4]</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> c.i.c.exception.GlobalExceptionHandler</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   :</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">### Error updating database.  Cause: com.mysql.cj.jdbc.exceptions.MySQLTransactionRollbackException: Deadlock found when trying to get lock; try restarting transaction</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">### The error may exist in file [/Users/xiaodaoxian/Desktop/work/code/ideamake-market-cloud-third-dock/target/classes/mapper/YxxWkBatchDataMapper.xml]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">### The error may involve defaultParameterMap</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">### The error occurred while setting parameters</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">### SQL: DELETE FROM xdx_test_two WHERE user_id = ?</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">### Cause: com.mysql.cj.jdbc.exceptions.MySQLTransactionRollbackException: Deadlock found when trying to get lock; try restarting transaction</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Deadlock</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> found</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> when</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> trying</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">try</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> restarting</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> transaction</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">nested</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> exception</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> com.mysql.cj.jdbc.exceptions.MySQLTransactionRollbackException:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Deadlock</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> found</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> when</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> trying</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">try</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> restarting</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> transaction</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><br><h2 id="一、理论-重要" tabindex="-1"><a class="header-anchor" href="#一、理论-重要"><span>一、理论（重要）</span></a></h2><p>所谓的死锁，一定是两个线程互相等待对方的资源。对于MySQL 来说，那就是两个<code>事物</code>锁住了对方的数据。</p><p>MySQL的innodb有 表锁、行锁，如果锁表那死锁的概率很大，一般我们操作都是带有参数的 <code>where user_id = &#39;xxx&#39;</code></p><p>理论上如果写<code>delete or update</code> 的时候带了上面的条件，按照我们的理解那就是行锁，并发情况下只要我们参数不一致那永远不会造成死锁</p><p>但实际情况总不会如人意的，我造成死锁的2个SQL就是上面这样的操作，两个删除都是带了 where，但还是锁表了</p><br><p><mark>MySQL InnoDB 引擎下，delete/update操作where后面的条件如果没有走索引，会锁表（MySQL 5.6/7 版本验证）</mark></p><br><p>请注意上面我说的是 <code>两个事物互相锁住了对方的资源</code> 而并不是简单的两个SQL，这也就是为什么需要熟悉业务代码的人去解决，一个复杂的业务可能涉及到七八张表的操作。</p><br><p>上面说了死锁产生的主要原因，下面再来说说死锁在业务中产生的几种可能和<code>解决办法</code></p><ol><li>一般来说我们代码不管哪个线程进来都是按顺序执行的，但实际情况是我们在代码中写了各种 if else 等条件语句，这样就导致每个请求实际操作表的顺序可能不一致了，就可能造成死锁（我遇到就是这样的），但这种情况大部分我们把表索引创建好，不出现锁表就没事了。</li><li>并发下相同的业务参数去执行，第一个事物还没提交后面的事物又来了，这种我们加分布式锁就好了</li></ol><br><h2 id="二、死锁实践" tabindex="-1"><a class="header-anchor" href="#二、死锁实践"><span>二、死锁实践</span></a></h2><h3 id="_2-1、建表" tabindex="-1"><a class="header-anchor" href="#_2-1、建表"><span>2-1、建表</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">xdx_test_one</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">\` (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  \`id\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  \`user_id\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">DEFAULT</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> COMMENT </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;用户uuid&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`id\`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) ENGINE</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">InnoDB AUTO_INCREMENT</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> DEFAULT</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> CHARSET</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">utf8mb4 COMMENT</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;测试表one&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">xdx_test_two</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">\` (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  \`id\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">11</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> AUTO_INCREMENT,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  \`user_id\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> varchar</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">DEFAULT</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> COMMENT </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;用户uuid&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`id\`</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) ENGINE</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">InnoDB AUTO_INCREMENT</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">7</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> DEFAULT</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> CHARSET</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">utf8mb4 COMMENT</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;测试表two&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><br><h3 id="_2-2、代码" tabindex="-1"><a class="header-anchor" href="#_2-2、代码"><span>2-2、代码</span></a></h3><h4 id="_2-2-1、controller" tabindex="-1"><a class="header-anchor" href="#_2-2-1、controller"><span>2-2-1、controller</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;">GetMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;/testLock&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> testLock</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;">RequestParam</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> params) throws InterruptedException {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    dataServiceImpl</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">testLock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(params);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><br><h4 id="_2-2-2、service" tabindex="-1"><a class="header-anchor" href="#_2-2-2、service"><span>2-2-2、service</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#E5C07B;">Transactional</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">rollbackFor</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> Exception</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">class</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> testLock</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> params) throws InterruptedException {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;one&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(params)</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        dataMapper</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">deleteOne</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">UUID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomUUID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">substring</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">18</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        System</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">out</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(params </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot; 获取 xdx_test_one 表锁&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        Thread</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">sleep</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    dataMapper</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">deleteTwo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">UUID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomUUID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">substring</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">18</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">    System</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">out</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(params </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot; 获取 xdx_test_two 表锁&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;two&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(params)</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        dataMapper</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">deleteOne</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">UUID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">randomUUID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">substring</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">18</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">        System</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">out</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(params </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot; 获取 xdx_test_one 表锁&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><br><h4 id="_2-2-3、mapper" tabindex="-1"><a class="header-anchor" href="#_2-2-3、mapper"><span>2-2-3、mapper</span></a></h4><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">delete</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;deleteOne&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    DELETE FROM xdx_test_one WHERE user_id = #{substring}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">delete</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">delete</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;deleteTwo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    DELETE FROM xdx_test_two WHERE user_id = #{substring}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">delete</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><br><h3 id="_2-3、测试" tabindex="-1"><a class="header-anchor" href="#_2-3、测试"><span>2-3、测试</span></a></h3><p>按照顺序快速的请求下面的url， 你就会看到上面的异常了</p><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">http://127.0.0.1:8080/testLock?parmas=one</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-http line-numbers-mode" data-highlighter="shiki" data-ext="http" data-title="http" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">http://127.0.0.1:8080/testLock?parmas=two</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><br><h3 id="_2-4、其它" tabindex="-1"><a class="header-anchor" href="#_2-4、其它"><span>2-4、其它</span></a></h3><p>我们要解决上面的死锁其实很简单，只需要给上面的 user_id 加一个索引就好了</p><br><h2 id="三、死锁分析" tabindex="-1"><a class="header-anchor" href="#三、死锁分析"><span>三、死锁分析</span></a></h2><br><h3 id="_3-1、阿里云日志分析" tabindex="-1"><a class="header-anchor" href="#_3-1、阿里云日志分析"><span>3-1、阿里云日志分析</span></a></h3><p>死锁我们一般是要看日志进行分析处理，其实只要找到两个事物之间谁拥有了对方的哪个锁即可，但原始的MySQL日志不大好看，刚好我们是使用的阿里云的服务版MySQL，它会把死锁日志进行分析以表格的方式展示，刚刚我们测试的死锁，表格呈现如下</p><figure><img src="`+n+`" alt="在这里插入图片描述" tabindex="0" loading="lazy"><figcaption>在这里插入图片描述</figcaption></figure><p>可以先大致看一下这个表结构，应该是很清晰的，不过这个表是存在一点问题的，那就是 <code>事物1 是持有 yx_mc.xdx_test_two 的锁</code> 不然是不构成死锁，这个阿里云解释说我们使用的数据库版本比较老，在新的版本已经解决了这个问题。</p><br><h3 id="_3-2、原始日志分析" tabindex="-1"><a class="header-anchor" href="#_3-2、原始日志分析"><span>3-2、原始日志分析</span></a></h3><p>看完了上面的表，我们对死锁的组成应该有了进一步的理解，下面我们来看看MySQL的原始死锁日志</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">LATEST</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DETECTED</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> DEADLOCK</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">------------------------</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">2022-06-16</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 17:25:01</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 7fde0b4a3700</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">***</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) TRANSACTION:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">TRANSACTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 36291462,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ACTIVE</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 0.717</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sec</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fetching</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rows</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tables</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> locked</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">LOCK</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> WAIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> heap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1184,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> undo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> entries</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">LOCK</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> BLOCKING</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> MySQL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> thread</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> id:</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 576129097</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> block</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 307687953</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">MySQL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> thread</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> id</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 307687953,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> thread</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> handle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0x7fdeda9fa700,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> query</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> id</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1317704191</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10.19.22.58</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> yx_property_test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> updating</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">DELETE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> xdx_test_one</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> user_id</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;11111&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">***</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) WAITING FOR THIS LOCK TO BE GRANTED:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">RECORD</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCKS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> space</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> id</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3212</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> page</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bits</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 88</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">PRIMARY</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">yx_mc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">xdx_test_one</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> trx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> id</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 36291462</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock_mode</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> X</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> locks</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rec</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> but</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> waiting</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Record</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> heap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PHYSICAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> RECORD:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> n_fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compact</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bits</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 32</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8000000b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">     ;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 1:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00000229c378</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    ) x;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 2:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0f0000001b0c25</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       %</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 3:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3131313131</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 11111</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">***</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (2) TRANSACTION:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">TRANSACTION</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 36291448,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ACTIVE</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2.005</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> sec</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> fetching</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rows</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tables</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> locked</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">5</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> heap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> size</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 1184,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> row</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">s</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> undo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> entries</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">MySQL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> thread</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> id</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 576129097,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> OS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> thread</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> handle</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0x7fde0b4a3700,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> query</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> id</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1317704227</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10.19.22.58</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> yx_property_test</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> updating</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">DELETE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> xdx_test_two</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> user_id</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &#39;22222&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">***</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) HOLDS THE LOCK(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">S</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">RECORD</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCKS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> space</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> id</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3212</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> page</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bits</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 88</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">PRIMARY</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">yx_mc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">xdx_test_one</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> trx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> id</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 36291448</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock_mode</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> X</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> locks</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rec</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> but</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gap</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Record</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> heap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 12</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PHYSICAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> RECORD:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> n_fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compact</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bits</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 32</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8000000b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">     ;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 1:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00000229c378</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    ) x;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 2:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0f0000001b0c25</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       %</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 3:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3131313131</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 11111</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Record</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> heap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 13</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PHYSICAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> RECORD:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> n_fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compact</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bits</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 32</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8000000c</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">     ;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 1:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00000229c378</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    ) x;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 2:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0f0000001b0c48</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       H</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 3:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3131313131</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 11111</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Record</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> heap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 14</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PHYSICAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> RECORD:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> n_fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compact</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bits</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 32</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8000000d</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">     ;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 1:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00000229c378</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    ) x;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 2:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0f0000001b0c6b</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">       k</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 3:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3131313131</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 11111</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Record</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> heap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 15</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PHYSICAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> RECORD:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> n_fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compact</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bits</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 32</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8000000e</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">     ;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 1:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00000229c378</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    ) x;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 2:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0f0000001b0c8e</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        ;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 3:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3131313131</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 11111</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Record</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> heap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 16</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PHYSICAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> RECORD:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> n_fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compact</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bits</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 32</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 8000000f</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">     ;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 1:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00000229c378</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    ) x;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 2:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0f0000001b0cb1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        ;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 3:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3131313131</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 11111</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Record</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> heap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 17</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PHYSICAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> RECORD:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> n_fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compact</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bits</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 32</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 80000010</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">     ;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 1:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00000229c378</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    ) x;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 2:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 0f0000001b0cd4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        ;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 3:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3131313131</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 11111</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">***</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (2) WAITING FOR THIS LOCK TO BE GRANTED:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">RECORD</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LOCKS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> space</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> id</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3213</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> page</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bits</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 88</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">PRIMARY</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">yx_mc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">xdx_test_two</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> trx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> id</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 36291448</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock_mode</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> X</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> locks</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> rec</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> but</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> gap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> waiting</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Record</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lock,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> heap</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> no</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 18</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PHYSICAL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> RECORD:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> n_fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">compact</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> format</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bits</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 32</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 0:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 80000017</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">     ;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 1:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 00000229c386</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    )  ;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 2:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 190000002116e0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     !</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  ;;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> 3:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">hex</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3232323232</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">asc</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 22222</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">***</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> WE</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ROLL</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> BACK</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> TRANSACTION</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (1)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><br><h2 id="n、其它" tabindex="-1"><a class="header-anchor" href="#n、其它"><span>N、其它</span></a></h2><h3 id="n-1、是不是真的需要事物" tabindex="-1"><a class="header-anchor" href="#n-1、是不是真的需要事物"><span>N-1、是不是真的需要事物</span></a></h3><p>其实我们可以反过来想一想，我们的代码是不是一定要加锁，有时候一个复杂的业务，你加锁，会不断的出现死锁，很难根除。</p><p>换个角度，如果我们去掉事物，是不是就没有死锁了？你可能觉得不加事物数据会异常，但是想一想如果频繁产生死锁你的数据不也没办法保证吗？如果我们把所有的异常都解决是不是就没问题了？</p><br><h3 id="n-2、拆分事物的颗粒度" tabindex="-1"><a class="header-anchor" href="#n-2、拆分事物的颗粒度"><span>N-2、拆分事物的颗粒度</span></a></h3><p>同上一个，如果事物粒度太大了，造成死锁的可能性就很大。我们可以根据业务去进行细分，把一个大的事物拆分成多个小的事物，以此来减少死锁的可能性。</p><br><h3 id="n-3、如果只有一个表是否会死锁" tabindex="-1"><a class="header-anchor" href="#n-3、如果只有一个表是否会死锁"><span>N-3、如果只有一个表是否会死锁</span></a></h3><p>只操作一个表是不会死锁的，第一个事物获取了锁，第二个事物就会进入等待，所以不会出现死锁。</p><br><h3 id="n-4、同一个代码是不是一定会造成死锁" tabindex="-1"><a class="header-anchor" href="#n-4、同一个代码是不是一定会造成死锁"><span>N-4、同一个代码是不是一定会造成死锁</span></a></h3><p>我们知道MySQL里面有一个关键字 <code>EXPLAIN</code> ，它可以分析SQL执行的结果，但实际上一定就按照这个去执行么？其实不然的，还有一个SQL优化器，最终执行的方式是由它来决定的。</p><p>上面同样的代码，在我本地数据库 where 后面的条件不管是什么都会造成死锁，而在阿里云的数据库上不会，必须要扫描到真实存在数据才会死锁。</p><br><h3 id="n-5、产生死锁的两个事物怎么办" tabindex="-1"><a class="header-anchor" href="#n-5、产生死锁的两个事物怎么办"><span>N-5、产生死锁的两个事物怎么办？</span></a></h3><p>从目前的数据来看，事物1 会执行成功，事物2 会回滚</p>`,70),t=[l];function p(e,d){return a(),i("div",null,t)}const F=s(k,[["render",p],["__file","Deadlock found when trying to get lock； try restarting transaction 【MySQL死锁问题解决】.html.vue"]]),y=JSON.parse('{"path":"/03%E6%95%B0%E6%8D%AE%E5%BA%93/01MySQL/Deadlock%20found%20when%20trying%20to%20get%20lock%EF%BC%9B%20try%20restarting%20transaction%20%E3%80%90MySQL%E6%AD%BB%E9%94%81%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E3%80%91.html","title":"【初】Deadlock found when trying to get lock； try restarting transaction 【MySQL死锁问题解决】","lang":"zh-CN","frontmatter":{"title":"【初】Deadlock found when trying to get lock； try restarting transaction 【MySQL死锁问题解决】","shortTitle":"【初】MySQL死锁问题","date":"2022-06-25T18:16:19.000Z","category":["初级","视频讲解"],"tag":["MySQL锁","死锁","行锁","表锁"],"description":"视频地址： https://www.bilibili.com/video/bv1zY411N7tB 最近在调试接口的时候遇到了MySQL死锁问题，我自己测试的时候一切都好好的，但在并发下，就死锁了 其实死锁问题，并没有一个类似“万金油”的解决办法，解铃还需系铃人，能做的只有写这个代码的人自己去解决 第一次出现死锁，想必你也会和我一样整个人都是懵的，不知...","head":[["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/03%E6%95%B0%E6%8D%AE%E5%BA%93/01MySQL/Deadlock%20found%20when%20trying%20to%20get%20lock%EF%BC%9B%20try%20restarting%20transaction%20%E3%80%90MySQL%E6%AD%BB%E9%94%81%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E3%80%91.html"}],["meta",{"property":"og:site_name","content":"小道仙Java笔记"}],["meta",{"property":"og:title","content":"【初】Deadlock found when trying to get lock； try restarting transaction 【MySQL死锁问题解决】"}],["meta",{"property":"og:description","content":"视频地址： https://www.bilibili.com/video/bv1zY411N7tB 最近在调试接口的时候遇到了MySQL死锁问题，我自己测试的时候一切都好好的，但在并发下，就死锁了 其实死锁问题，并没有一个类似“万金油”的解决办法，解铃还需系铃人，能做的只有写这个代码的人自己去解决 第一次出现死锁，想必你也会和我一样整个人都是懵的，不知..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-07-28T04:02:10.000Z"}],["meta",{"property":"article:author","content":"小道仙97"}],["meta",{"property":"article:tag","content":"MySQL锁"}],["meta",{"property":"article:tag","content":"死锁"}],["meta",{"property":"article:tag","content":"行锁"}],["meta",{"property":"article:tag","content":"表锁"}],["meta",{"property":"article:published_time","content":"2022-06-25T18:16:19.000Z"}],["meta",{"property":"article:modified_time","content":"2024-07-28T04:02:10.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"【初】Deadlock found when trying to get lock； try restarting transaction 【MySQL死锁问题解决】\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-06-25T18:16:19.000Z\\",\\"dateModified\\":\\"2024-07-28T04:02:10.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"小道仙97\\",\\"url\\":\\"https://java.xdx97.com\\"}]}"]]},"headers":[{"level":2,"title":"一、理论（重要）","slug":"一、理论-重要","link":"#一、理论-重要","children":[]},{"level":2,"title":"二、死锁实践","slug":"二、死锁实践","link":"#二、死锁实践","children":[{"level":3,"title":"2-1、建表","slug":"_2-1、建表","link":"#_2-1、建表","children":[]},{"level":3,"title":"2-2、代码","slug":"_2-2、代码","link":"#_2-2、代码","children":[]},{"level":3,"title":"2-3、测试","slug":"_2-3、测试","link":"#_2-3、测试","children":[]},{"level":3,"title":"2-4、其它","slug":"_2-4、其它","link":"#_2-4、其它","children":[]}]},{"level":2,"title":"三、死锁分析","slug":"三、死锁分析","link":"#三、死锁分析","children":[{"level":3,"title":"3-1、阿里云日志分析","slug":"_3-1、阿里云日志分析","link":"#_3-1、阿里云日志分析","children":[]},{"level":3,"title":"3-2、原始日志分析","slug":"_3-2、原始日志分析","link":"#_3-2、原始日志分析","children":[]}]},{"level":2,"title":"N、其它","slug":"n、其它","link":"#n、其它","children":[{"level":3,"title":"N-1、是不是真的需要事物","slug":"n-1、是不是真的需要事物","link":"#n-1、是不是真的需要事物","children":[]},{"level":3,"title":"N-2、拆分事物的颗粒度","slug":"n-2、拆分事物的颗粒度","link":"#n-2、拆分事物的颗粒度","children":[]},{"level":3,"title":"N-3、如果只有一个表是否会死锁","slug":"n-3、如果只有一个表是否会死锁","link":"#n-3、如果只有一个表是否会死锁","children":[]},{"level":3,"title":"N-4、同一个代码是不是一定会造成死锁","slug":"n-4、同一个代码是不是一定会造成死锁","link":"#n-4、同一个代码是不是一定会造成死锁","children":[]},{"level":3,"title":"N-5、产生死锁的两个事物怎么办？","slug":"n-5、产生死锁的两个事物怎么办","link":"#n-5、产生死锁的两个事物怎么办","children":[]}]}],"git":{"createdTime":1722139330000,"updatedTime":1722139330000,"contributors":[{"name":"ziyangtao","email":"ziyangtao@distinctclinic.com","commits":1}]},"readingTime":{"minutes":7.74,"words":2322},"filePathRelative":"03数据库/01MySQL/Deadlock found when trying to get lock； try restarting transaction 【MySQL死锁问题解决】.md","localizedDate":"2022年6月26日","excerpt":"<br>\\n<p>视频地址： <a href=\\"https://www.bilibili.com/video/bv1zY411N7tB\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://www.bilibili.com/video/bv1zY411N7tB</a></p>\\n<p><br><br></p>\\n<blockquote>\\n<p>最近在调试接口的时候遇到了MySQL死锁问题，我自己测试的时候一切都好好的，但在并发下，就死锁了 <br>\\n其实死锁问题，并没有一个类似“万金油”的解决办法，解铃还需系铃人，能做的只有写这个代码的人自己去解决 <br>\\n第一次出现死锁，想必你也会和我一样整个人都是懵的，不知道如何下手，等你看过下面的文章明白了死锁，就不会害怕了</p>\\n</blockquote>","autoDesc":true}');export{F as comp,y as data};
